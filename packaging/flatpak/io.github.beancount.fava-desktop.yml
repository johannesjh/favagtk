app-id: io.github.beancount.fava-desktop
runtime: org.gnome.Platform
runtime-version: '3.38'
sdk: org.gnome.Sdk
command: fava-desktop
finish-args:
  - --share=network
  - - --socket=wayland
  - --socket=fallback-x11
  - --filesystem=home
  - --device=dri
modules:
  - name: fava-desktop
    buildsystem: simple
    build-commands:
      - pip3 install --no-index  --find-links=./dist --prefix=${FLATPAK_DEST} fava fava-desktop
      - mkdir -p /app/share/icons/hicolor/scalable/apps/
      - cp fava/contrib/icon.svg /app/share/icons/hicolor/scalable/apps/${FLATPAK_ID}.svg
      - mkdir -p /app/share/applications/
      - cp packaging/flatpak/io.github.beancount.fava-desktop.desktop /app/share/applications/
      - desktop-file-validate /app/share/applications/io.github.beancount.fava-desktop.desktop
    sources:
      - type: dir
        path: ../..
